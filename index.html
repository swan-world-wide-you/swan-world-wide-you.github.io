<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/brain.js"></script>
</head>
<body>
    <h1>DataVisualizer</h1>
    <input type="color" id="input_color"><button onclick="isDark()">明暗判定</button>
    <div id="result"></div>
    <script>
        // brain.js はじめ
        const net = new brain.recurrent.LSTMTimeStep({
          inputSize: 2,
          hiddenLayers: [10],
          outputSize: 2,
        });

        // Same test as previous, but combined on a single set
        const trainingData = [
          [
            [1, 5],
            [2, 4],
            [3, 3],
            [4, 2],
            [5, 1],
          ],
        ];

        net.train(trainingData, { log: true, errorThresh: 0.09 });

        const closeToFiveAndOne = net.run([
          [1, 5],
          [2, 4],
          [3, 3],
          [4, 2],
        ]);

        console.log(closeToFiveAndOne);

        // now we're cookin' with gas!
        const forecast = net.forecast(
          [
            [1, 5],
            [2, 4],
          ],
          3
        );

        console.log('next 3 predictions', forecast);
        // brain.js おわり
        
        // ニューラルネットワークによる色判定
        const net2 = new brain.NeuralNetwork();
        // Train the Network with 4 input objects
        net2.train([
        // White RGB(255, 255, 255)
        {input:[255/255, 255/255, 255/255], output:{light:1}},
        // Light grey (192,192,192)
        {input:[192/255, 192/255, 192/255], output:{light:1}},
        // Darkgrey (64, 64, 64)
        {input:[65/255, 65/255, 65/255], output:{dark:1}},
        // Black (0, 0, 0)
        {input:[0, 0, 0], output:{dark:1}},
        ]);

        function isDark(){
        // What is the expected output of Dark Blue (0, 0, 128);
            const color = document.getElementById("input-color").value;
            const r = parseInt(color.substr(1,2),10);
            const g = parseInt(color.substr(3,2),10);
            const b = parseInt(color.substr(5,2),10);
        let result = net2.run([r, g, b]);

        // Display the probability of "dark" and "light"
        document.getElementById("result").innerHTML = "暗い確率:" + result["dark"] + " / 明るい確率" + result["light"];
        }
    
    </script>
</body>
</html>
